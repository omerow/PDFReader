<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profesyonel PDF Flipbook</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/dflip@1.0.12/css/dflip.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/dflip@1.0.12/css/themify-icons.min.css">

    <style>
        body { margin: 0; background-color: #1a1a1a; color: white; font-family: sans-serif; height: 100vh; display: flex; flex-direction: column; }
        .controls { padding: 15px; text-align: center; background: #222; z-index: 999; border-bottom: 2px solid #3498db; }
        #flipbook-wrapper { flex-grow: 1; position: relative; width: 100%; height: calc(100vh - 80px); }
        .btn-upload { padding: 12px 24px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 14px; }
        .btn-upload:hover { background: #2980b9; }
        #status { margin-top: 8px; font-size: 12px; color: #888; }
    </style>
</head>
<body>

    <div class="controls">
        <input type="file" id="file-input" accept="application/pdf" style="display:none;">
        <button class="btn-upload" onclick="document.getElementById('file-input').click()">PDF DOSYASI SEÇ VE OKU</button>
        <div id="status">Henüz bir dosya seçilmedi.</div>
    </div>

    <div id="flipbook-wrapper">
        <div id="df_viewer"></div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dflip@1.0.12/js/dflip.min.js"></script>

    <script>
        $(document).ready(function () {
            // dFlip kütüphanesinin yüklendiğinden emin olalım
            if (typeof DFLIP === "undefined") {
                $("#status").text("Hata: Kütüphane yüklenemedi. Lütfen internet bağlantınızı kontrol edin.");
                return;
            }

            $('#file-input').on('change', function (e) {
                const file = e.target.files[0];
                if (!file || file.type !== "application/pdf") {
                    alert("Lütfen geçerli bir PDF dosyası seçin.");
                    return;
                }

                $("#status").text("İşleniyor: " + file.name);

                const reader = new FileReader();
                reader.onload = function(event) {
                    const blob = new Blob([event.target.result], { type: 'application/pdf' });
                    const fileURL = URL.createObjectURL(blob);

                    // Eğer önceden bir kitap varsa temizle
                    if (window.myFlipbook) {
                        window.myFlipbook.dispose();
                    }

                    // Flipbook seçenekleri
                    const options = {
                        source: fileURL,
                        webgl: true,
                        hard: "none",
                        direction: DFLIP.DIRECTION.LTR,
                        duration: 800,
                        backgroundColor: "#1a1a1a"
                    };

                    // jQuery eklentisi yerine doğrudan DFLIP nesnesini kullanmak daha güvenlidir
                    window.myFlipbook = new DFlip("#df_viewer", options);
                    
                    $("#status").text("Dosya başarıyla yüklendi: " + file.name);
                };

                reader.readAsArrayBuffer(file);
            });
        });
    </script>
</body>
</html>